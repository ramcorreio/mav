<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:f="http://xmlns.jcp.org/jsf/core"
				xmlns:h="http://xmlns.jcp.org/jsf/html"
    			xmlns:p="http://primefaces.org/ui"
    			xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    			xmlns:pe="http://primefaces.org/ui/extensions"
    			>
    
	<p:panelGrid>
		<p:row rendered="#{cRUDViewContractStates.renderEditForm}">
			<p:column>
				<h:outputLabel for="id_id" value="ID:" styleClass="crud-input-label" style="text-align:right"/>
			</p:column>
			<p:column>		
		   		<p:inputText id="id_id" value="#{contractView.dto.contract.id}" styleClass="crud-input-value" readonly="true" />
	   		</p:column>
		</p:row>
		
		<p:row>
			<p:column>
				<h:outputLabel for="customer_id" value="Matriz:" styleClass="crud-input-label"/>	
	   		</p:column>
	   		<p:column>
				<p:autoComplete  id="customer_id" value="#{contractView.dto.contract.owner.office}" 
				completeMethod="#{contractView.completeTextHO}" 
				var="t"
				itemLabel="#{t.name}" 
				itemValue="#{t}"
				converter="headOfficeConverter" 
				forceSelection="true" 
				dropdown="true"
				>
				<p:ajax event="itemSelect" listener="#{contractView.selectHeadOfficer}" />
				
				</p:autoComplete>
	   		</p:column>
		</p:row>
		
		<p:row>
			<p:column>
				<h:outputLabel for="subsidiary_id" value="Filial:" styleClass="crud-input-label"/>	
	   		</p:column>
	   		<p:column>
				<p:autoComplete  id="subsidiary_id" value="#{contractView.dto.contract.owner}" 
				completeMethod="#{contractView.completeTextSub}" 
				var="theme"
				itemLabel="#{theme.name}" 
				itemValue="#{theme}"
				converter="subsidiaryConverter" 
				forceSelection="true" 
				dropdown="true">
				</p:autoComplete>
	   		</p:column>
		</p:row>
		
	   	<p:row>
			<p:column>
			   	<h:outputLabel for="frequencia_id" value="Frequência:" styleClass="crud-input-label"/>
		   	</p:column>
			<p:column>
				<p:autoComplete  id="frequencia_id" value="#{contractView.dto.contract.frequency}" 
					completeMethod="#{contractView.completeTextFrequencies}" 
					var="freq"
					itemLabel="#{freq}" 
					itemValue="#{freq}"
					forceSelection="true" 
					dropdown="true">
				</p:autoComplete>
 	   		</p:column>
		</p:row>
	   	
	   	<p:row>
			<p:column>
	   			<h:outputLabel for="nf_id" value="Possui NF:" styleClass="crud-input-label"/>
	   		</p:column>
			<p:column>	
	   			<p:selectBooleanButton id="nf_id" value="#{contractView.dto.contract.nf}" styleClass="crud-input-value" onLabel="Yes" offLabel="No" onIcon="ui-icon-check" offIcon="ui-icon-close" style="width:60px"/>
  	   		</p:column>
		</p:row>
	   	
	   	<p:row>
			<p:column>
	   			<h:outputLabel for="startDate_id" value="Início do Contrato:" styleClass="crud-input-label"/>
	   		</p:column>
			<p:column>	
	   			<p:calendar id="startDate_id" value="#{contractView.dto.contract.startDate}" styleClass="crud-input-value" showButtonPanel="true"/>
 		 	</p:column>
		</p:row>
	   	
	   	<p:row>
			<p:column>
	   			<h:outputLabel for="expirationDate_id" value="Fim do Contrato:" styleClass="crud-input-label"/>
	   		</p:column>
			<p:column>	
	   			<p:calendar id="expirationDate_id" value="#{contractView.dto.contract.expirationDate}" styleClass="crud-input-value" showButtonPanel="true"/>
 			</p:column>
		</p:row>
		
		<p:row>
			<p:column>
				<h:outputLabel for="expirationDay_id" value="Dia de cobrança:" styleClass="crud-input-label"/>
	   		</p:column>
			<p:column style="text-align:left">	
        		<p:spinner id="expirationDay_id" value="#{contractView.dto.contract.expirationDay}" min="1" max="31" styleClass="crud-input-label" style="align: left" />
 			</p:column>
		</p:row>
	   	
  	</p:panelGrid>
  	
  	
  	
  	<hr/>

<h:form id="newservices_id">  	
  	<p:panelGrid>
  		<f:facet name="header">
  			<p:row>
  				<p:column>
  					<p:outputLabel value="Serviço"/>
  				</p:column>
  				<p:column>
  					<p:outputLabel value="Preço original"/>
  				</p:column>
  				<p:column>
  					<p:outputLabel value="Preço unitário"/>
  				</p:column>
  				<p:column>
  					<p:outputLabel value="Quantidade"/>
  				</p:column>
  			</p:row>
  		</f:facet>
  		<p:row>
  			<p:column style="width:200px">
				<p:autoComplete  id="services_id" value="#{contractView.selectedService.service}" 
					completeMethod="#{contractView.completeTextServices}" 
					var="service"
					itemLabel="#{service.description}" 
					itemValue="#{service}"
					converter="servicesConverter" 
					forceSelection="true" 
					dropdown="true"
					/>
			</p:column>
			<p:column>
				<p:outputLabel value="#{contractView.dto.service.value}"/>
			</p:column>
			<p:column>
				<pe:inputNumber id="service_unityprice_id" value="#{contractView.selectedService.unitValue}" />
			</p:column>
			<p:column>
				<p:spinner id="service_quantity_id" value="#{contractView.selectedService.quantity}" styleClass="crud-input-label" style="align: left" />
			</p:column>
			<p:column>
				<p:commandButton value="Adicionar" actionListener="#{contractView.adicionarServico}" process="newservices_id">
					<f:ajax render="@form" delay="1000"/>
				</p:commandButton>
			</p:column>
		</p:row>
		<p:row>
			<p:column colspan="4">
				<p:inputTextarea value="#{contractView.selectedService.description}"/>
			</p:column>
		</p:row>
  	</p:panelGrid>
  	
  	
  	<p:dataTable var="ss" value="#{contractView.dto.contract.services}">
	    <p:column headerText="Serviço">
	        <h:outputText value="#{ss.service.description}" />
	    </p:column>
	 	<p:column headerText="Preço Original">
	        <h:outputText value="#{ss.service.value}" />
	    </p:column>
	    <p:column headerText="Preço unitário">
	        <h:outputText value="#{ss.unitValue}" />
	    </p:column>
	    <p:column headerText="Quantidade">
	        <h:outputText value="#{ss.quantity}" />
	    </p:column>
	    <p:column headerText="Total">
	        <h:outputText value="#{ss.unitValue * ss.quantity}" />
	    </p:column>
	    <p:column headerText="Descrição">
	        <h:outputText value="#{ss.description}" />
	    </p:column>
	    <p:column headerText="Remover">
		    <p:commandButton title="Remover" actionListener="#{contractView.removerServico(ss)}" icon="ui-icon-trash" />
	    </p:column>
	</p:dataTable>
	</h:form> 
  	
</ui:composition>