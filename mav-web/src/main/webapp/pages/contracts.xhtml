<!DOCTYPE html>
<html lang="pt" xmlns="http://www.w3.org/1999/xhtml"
				xmlns:f="http://xmlns.jcp.org/jsf/core"
				xmlns:h="http://xmlns.jcp.org/jsf/html"
    			xmlns:p="http://primefaces.org/ui"
    			xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
	<ui:decorate template="/restrict/template/crudtemplate.xhtml">
	
		<ui:param name="crudstates" value="#{cRUDViewContractStates}" />
		<ui:param name="crudevents" value="#{cRUDViewContractEvents}" />
		
	    <ui:define name="crudInsertForm">
			<ui:include src="contracts/contractsInsertForm.xhtml"/>
	    </ui:define>		
	    
	    
	    
	    <ui:define name="crudEditForm">
			<ui:include src="contracts/contractsInsertForm.xhtml"/>
	    </ui:define>	
	    
		<ui:define name="crudMainForm">
		
	    	<p:dataTable
					id="contractList"
					var="contract"
					value="#{crudevents.contractView.dto.contracts}"
					selection="#{crudevents.contractView.dto.contract}"
					rowKey="#{contract.id}"
					paginator="true"
					rows="25"
					paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
					emptyMessage="Faça uma pesquisa para consultar resultados"
					rowsPerPageTemplate="10,25,50,100"
					currentPageReportTemplate="({currentPage} de {totalPages})">
					
						<p:column headerText="Id" sortBy="#{contract.id}" width="30">
							<h:outputText value="#{contract.id}" />
						</p:column>
						
						<p:column headerText="NF" width="25">
							<h:outputText value="Sim" rendered="#{contract.nf}" />
							<h:outputText value="Não" rendered="#{not contract.nf}" />
						</p:column>
						
						<p:column headerText="Dia" width="25">
							<h:outputText value="#{contract.expirationDay}"/>
						</p:column>
						
						<p:column headerText="Período" width="90">
							<h:outputText value="#{contract.frequency}"/>
						</p:column>
						
						<p:column headerText="Início" sortBy="#{contract.startDate}" width="100">
							<h:outputText value="#{contract.startDate}">
								<f:convertDateTime pattern="dd/MM/yyyy"/>
							</h:outputText>
						</p:column>
						
						<p:column headerText="Vencimento" sortBy="#{contract.expirationDate}" width="120">
							<h:outputText value="#{contract.expirationDate}">
								<f:convertDateTime pattern="dd/MM/yyyy"/>
							</h:outputText>
						</p:column>
						
						<p:column headerText="Responsável" sortBy="#{contract.owner.office.name}">
							<h:outputText value="#{contract.owner.office.name}" /> - <h:outputText value="#{contract.owner.name}" />
						</p:column>
						
						<p:column headerText="Editar" width="50">
							<p:commandButton title="Editar" actionListener="#{crudstates.changeToEditState}" icon="ui-icon-disk" >
								<f:setPropertyActionListener target="#{contractView.dto.contract}" value="#{contract}" />
								<f:ajax render="fMain fEdit fNew" ></f:ajax>
							</p:commandButton>
						</p:column>
				</p:dataTable>
	    </ui:define>
	    
	</ui:decorate>
	
</html>